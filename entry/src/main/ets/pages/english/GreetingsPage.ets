import router from '@ohos.router';

// å®šä¹‰é—®å€™è¯­æ¥å£
interface GreetingItem {
  english: string;
  chinese: string;
  usage: string;
}

// å®šä¹‰é—®é¢˜æ¥å£
interface QuestionItem {
  question: string;
  options: string[];
  answer: number;
}

@Entry
@Component
export struct GreetingsPage {
  // å¸¸ç”¨é—®å€™è¯­åˆ—è¡¨
  private greetingsList: Array<GreetingItem> = [
    { 
      english: 'Hello!', 
      chinese: 'ä½ å¥½ï¼', 
      usage: 'æœ€å¸¸ç”¨çš„é—®å€™è¯­ï¼Œé€‚ç”¨äºä»»ä½•æ—¶é—´' 
    },
    { 
      english: 'Hi!', 
      chinese: 'ä½ å¥½ï¼', 
      usage: 'æ¯”Helloæ›´éšæ„çš„é—®å€™è¯­' 
    },
    { 
      english: 'Good morning!', 
      chinese: 'æ—©ä¸Šå¥½ï¼', 
      usage: 'ä¸Šåˆæ—¶ä½¿ç”¨çš„é—®å€™è¯­' 
    },
    { 
      english: 'Good afternoon!', 
      chinese: 'ä¸‹åˆå¥½ï¼', 
      usage: 'ä¸‹åˆæ—¶ä½¿ç”¨çš„é—®å€™è¯­' 
    },
    { 
      english: 'Good evening!', 
      chinese: 'æ™šä¸Šå¥½ï¼', 
      usage: 'å‚æ™šæˆ–æ™šä¸Šæ—¶ä½¿ç”¨çš„é—®å€™è¯­' 
    },
    { 
      english: 'How are you?', 
      chinese: 'ä½ å¥½å—ï¼Ÿ', 
      usage: 'è¯¢é—®å¯¹æ–¹è¿‘å†µ' 
    },
    { 
      english: 'How is it going?', 
      chinese: 'æœ€è¿‘æ€ä¹ˆæ ·ï¼Ÿ', 
      usage: 'æ¯”è¾ƒéšæ„çš„è¯¢é—®è¿‘å†µ' 
    }
  ];

  // äº’åŠ¨ç»ƒä¹ é¢˜ç›®
  @State currentQuestionIndex: number = 0;
  private questions: Array<QuestionItem> = [
    {
      question: 'æ—©ä¸Šé‡åˆ°åŒå­¦åº”è¯¥è¯´ä»€ä¹ˆï¼Ÿ',
      options: ['Good afternoon!', 'Good morning!', 'Good evening!', 'Bye!'],
      answer: 1
    },
    {
      question: 'ä¸‹åˆè§åˆ°è€å¸ˆåº”è¯¥è¯´ä»€ä¹ˆï¼Ÿ',
      options: ['Good morning!', 'Hello!', 'Good afternoon!', 'Good night!'],
      answer: 2
    },
    {
      question: 'å“ªä¸€ä¸ªæ˜¯"ä½ å¥½"çš„è‹±æ–‡ï¼Ÿ',
      options: ['Bye!', 'Hi!', 'Thank you!', 'Sorry!'],
      answer: 1
    }
  ];
  
  @State selectedOption: number = -1;
  @State showResult: boolean = false;
  @State isCorrect: boolean = false;

  build() {
    Column() {
      // æ ‡é¢˜æ 
      Row() {
           Button('è¿”å›')
          .onClick(() => {
            router.back();
          })
          .margin({ left: 10 })
          .type(ButtonType.Normal)
          .borderRadius(20)
          .width(80)
          .height(40)
          .fontSize(16)
          .fontWeight(FontWeight.Medium)
          .backgroundColor($r('app.color.card_background'))
          .fontColor($r('app.color.text_primary'))
          .animation({ duration: 300 })
          .shadow({
            radius: 5,
            color: $r('app.color.text_tertiary_bank_card_03'),
            offsetX: 0,
            offsetY: 2
          })
        
        Text('è‹±è¯­é—®å€™è¯­')
          .fontSize(24)
          .fontWeight(FontWeight.Bold)
          .layoutWeight(1)
          .textAlign(TextAlign.Center)
          .fontColor($r('app.color.text_primary'))
      }
      .height(60)
      .alignItems(VerticalAlign.Center)
      .backgroundColor($r('app.color.card_background'))
      
      Scroll() {
        Column() {
          // ä»‹ç»éƒ¨åˆ†
          Column() {
            Text('é—®å€™è¯­å­¦ä¹ ')
              .fontSize(20)
              .fontWeight(FontWeight.Bold)
              .fontColor($r('app.color.text_primary'))
              .margin({ top: 20 })
            
            Text('é—®å€™è¯­æ˜¯è‹±è¯­äº¤æµçš„ç¬¬ä¸€æ­¥ï¼Œæ­£ç¡®çš„é—®å€™èƒ½ç»™äººç•™ä¸‹è‰¯å¥½çš„å°è±¡ã€‚')
              .fontSize(14)
              .fontColor($r('app.color.text_secondary'))
              .margin({ top: 10, left: 20, right: 20 })
              .textAlign(TextAlign.Center)
          }
          
          // é—®å€™è¯­åˆ—è¡¨
          Column() {
            Text('å¸¸ç”¨é—®å€™è¯­')
              .fontSize(18)
              .fontWeight(FontWeight.Bold)
              .fontColor($r('app.color.text_primary'))
              .margin({ top: 20, bottom: 10 })
            
            ForEach(this.greetingsList, (item: GreetingItem, index: number) => {
              Row() {
                Column() {
                  Text(item.english)
                    .fontSize(16)
                    .fontWeight(FontWeight.Bold)
                    .fontColor($r('app.color.text_primary'))
                  
                  Text(item.chinese)
                    .fontSize(14)
                    .fontColor($r('app.color.text_secondary'))
                    .margin({ top: 2 })
                  
                  Text(item.usage)
                    .fontSize(12)
                    .fontColor($r('app.color.text_tertiary'))
                    .margin({ top: 3 })
                }
                .layoutWeight(1)
                
                // æ³¨é‡Šæ‰ä¸å­˜åœ¨çš„èµ„æºå¼•ç”¨ï¼Œé¿å…ç¼–è¯‘é”™è¯¯
                // Image($r('app.media.speaker'))
                //   .width(24)
                //   .height(24)
                //   .margin({ right: 15 })
                //   .onClick(() => {
                //     // æ¨¡æ‹Ÿæœ—è¯»å‘éŸ³
                //     console.log('Playing pronunciation for:', item.english);
                //   })
              }
              .padding({ left: 20, right: 20, top: 10, bottom: 10 })
              .backgroundColor($r('app.color.card_background'))
              .borderRadius(10)
              .margin({ left: 15, right: 15 })
              .shadow({ radius: 6, color: $r('app.color.text_tertiary'), offsetX: 0, offsetY: 2 })
            }, (item: GreetingItem) => item.english)
          }
          .width('100%')
          .margin({ top: 10 })
          
          // ä½¿ç”¨åœºæ™¯è¯´æ˜
          Column() {
            Text('ä½¿ç”¨åœºæ™¯')
              .fontSize(18)
              .fontWeight(FontWeight.Bold)
              .fontColor($r('app.color.text_primary'))
              .margin({ top: 20, bottom: 10 })
            
            Row() {
              Column() {
                Text('â€¢ Hello/Hi: é€‚ç”¨äºä»»ä½•æ—¶é—´ï¼Œæ˜¯æœ€é€šç”¨çš„é—®å€™è¯­\n' +
                     'â€¢ Good morning: é€‚ç”¨äºä¸Šåˆï¼ˆé€šå¸¸åˆ°ä¸­åˆ12ç‚¹ï¼‰\n' +
                     'â€¢ Good afternoon: é€‚ç”¨äºä¸‹åˆï¼ˆä¸­åˆ12ç‚¹åˆ°å‚æ™š6ç‚¹ï¼‰\n' +
                     'â€¢ Good evening: é€‚ç”¨äºå‚æ™šå’Œæ™šä¸Šï¼ˆä¸‹åˆ6ç‚¹ä»¥åï¼‰')
                  .fontSize(14)
                  .fontColor($r('app.color.text_secondary'))
                  .textAlign(TextAlign.Start)
              }
              .layoutWeight(1)
              .padding({ left: 20, right: 20 })
            }
            .width('100%')
          }
          
          // è¶£å‘³äº’åŠ¨ç»ƒä¹ 
          Column() {
            Text('è¶£å‘³ç»ƒä¹ ')
              .fontSize(18)
              .fontWeight(FontWeight.Bold)
              .fontColor($r('app.color.text_primary'))
              .margin({ top: 20, bottom: 10 })
            
            Column() {
              // é¢˜ç›®
              Text(this.questions[this.currentQuestionIndex].question)
                .fontSize(16)
                .fontWeight(FontWeight.Bold)
                .fontColor($r('app.color.text_primary'))
                .margin({ bottom: 20 })
                .textAlign(TextAlign.Center)
              
              // é€‰é¡¹
              ForEach(this.questions[this.currentQuestionIndex].options, (option: string, index: number) => {
                Row() {
                  Text(option)
                    .fontSize(14)
                    .fontColor($r('app.color.text_primary'))
                    .layoutWeight(1)
                
                  // é€‰æ‹©æ ‡è®°ï¼ˆä½¿ç”¨æ–‡æœ¬ä»£æ›¿å›¾ç‰‡ï¼‰
                  if (this.selectedOption === index) {
                    Text('âœ“')
                      .fontSize(20)
                      .fontColor('#4CAF50')
                  } else {
                    Text('â—‹')
                      .fontSize(20)
                      .fontColor($r('app.color.text_tertiary'))
                  }
                }
                .padding({ left: 15, right: 15, top: 10, bottom: 10 })
                .backgroundColor(this.selectedOption === index ? $r('app.color.card_background') : $r('app.color.card_background'))
                .borderRadius(8)
                .margin({ left: 20, right: 20, bottom: 10 })
                .onClick(() => {
                  this.selectedOption = index;
                })
              }, (option: string) => option)
              
              // æäº¤æŒ‰é’®
              Button('æäº¤ç­”æ¡ˆ')
                .onClick(() => {
                  if (this.selectedOption !== -1) {
                    this.isCorrect = (this.selectedOption === this.questions[this.currentQuestionIndex].answer);
                    this.showResult = true;
                  }
                })
                .margin({ top: 10,bottom:80 })
                .type(ButtonType.Normal)
                .enabled(this.selectedOption !== -1)
              
              // ç»“æœæ˜¾ç¤º
              if (this.showResult) {
                Column() {
                  Text(this.isCorrect ? 'å›ç­”æ­£ç¡®! ğŸ‰' : 'å›ç­”é”™è¯¯ï¼Œå†è¯•è¯•çœ‹!')
                    .fontSize(16)
                    .fontWeight(FontWeight.Bold)
                    .fontColor(this.isCorrect ? '#4CAF50' : '#F44336')
                    .margin({ top: 10 })
                  
                  if (!this.isCorrect) {
                    Text('æ­£ç¡®ç­”æ¡ˆ: ' + this.questions[this.currentQuestionIndex].options[this.questions[this.currentQuestionIndex].answer])
                      .fontSize(14)
                      .fontColor($r('app.color.text_secondary'))
                      .margin({ top: 5 })
                  }
                  
                  // ä¸‹ä¸€é¢˜æŒ‰é’®
                  Button('ä¸‹ä¸€é¢˜')
                    .onClick(() => {
                      this.showResult = false;
                      this.selectedOption = -1;
                      this.currentQuestionIndex = (this.currentQuestionIndex + 1) % this.questions.length;
                    })
                    .margin({ top: 10 ,bottom:80})
                    .type(ButtonType.Normal)
                }
                .padding({ top: 10, bottom: 10 })
                .backgroundColor($r('app.color.card_background'))
                .borderRadius(15)
                .margin({ left: 15, right: 15 })
              }
            }
            .padding({ left: 10, right: 10, top: 10, bottom: 20 })
            .backgroundColor($r('app.color.card_background'))
            .borderRadius(15)
            .margin({ left: 15, right: 15 })
          }
          
          // é¼“åŠ±æ€§æ–‡å­—å’Œè¡¨æƒ…
          Column() {
            Text('ä½ å·²ç»å¾ˆæ£’äº†ï¼ç»§ç»­åŠ æ²¹ï¼ğŸ˜Š')
              .fontSize(16)
              .fontWeight(FontWeight.Bold)
              .fontColor('#4CAF50')
              .textAlign(TextAlign.Center)
              .margin({ top: 30, bottom: 20 })

          }
          .width('100%')
          .padding({ left: 20, right: 20 })
          
          Blank()
        }
        .width('100%')
      }
      .layoutWeight(1)
      .edgeEffect(EdgeEffect.Spring)
    }
    .width('100%')
    .height('100%')
    .backgroundColor($r('app.color.page_background'))
  }
}