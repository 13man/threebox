import { ChinesePage } from './ChinesePage'
import { FamousPoetsListPage } from './chinese/FamousPoetsListPage'
import { FunFillPage } from './chinese/FunFillPage'
import HandwritingPage from './chinese/HandwritingPage'
import { PoetryLivePage } from './chinese/PoetryLivePage'
import { ProfilePage } from './ProfilePage'

@Entry
@Component
struct MainPage {
  @State selectedIndex: number = 0
  @State poetryLiveVisible: boolean = false  // Track Poetry Live tab visibility

  @Builder
  TabBuilder(text: string, index: number, icon: string) {
    Column() {
      Text(icon)
        .fontSize(13)
        .fontColor(this.selectedIndex === index ? $r('app.color.primary_brand') : $r('app.color.text_tertiary'))
      
      Text(text)
        .fontSize(this.selectedIndex === index ? 15 : 13)
        .fontWeight(this.selectedIndex === index ? FontWeight.Medium : FontWeight.Normal)
        .fontColor(this.selectedIndex === index ? $r('app.color.primary_brand') : $r('app.color.text_secondary'))
        .margin({ top: 2 })
    }
    .alignItems(HorizontalAlign.Center)
    .padding({ top: 6, bottom: 6 })
  }

  build() {
    Column() {
      Tabs({}) {
        TabContent() {
          ChinesePage()
        }
        .tabBar(this.TabBuilder('åŒ£', 0, 'ğŸ“œ'))

        TabContent() {
          FamousPoetsListPage()
        }
        .tabBar(this.TabBuilder('è‘—åè¯—äºº', 1, 'ğŸ–‹ï¸'))

        TabContent() {
          FunFillPage()
        }
        .tabBar(this.TabBuilder('è¶£å¡«', 2, 'ğŸ“'))

        TabContent() {
          PoetryLivePage({ isVisible: this.poetryLiveVisible })
        }
        .tabBar(this.TabBuilder('åŠ¨æ€ç”»å·', 3, 'ğŸ¬'))

      /*  TabContent() {
          HandwritingPage()
        }
        .tabBar(this.TabBuilder('è¶£å‘³ç¬”ç”»', 4, 'âœï¸'))
*/
        TabContent() {
          ProfilePage()
        }
        .tabBar(this.TabBuilder('æˆ‘çš„', 4, 'ğŸ‘¤'))
      }
      .barPosition(BarPosition.End) // Move tabs to bottom
      .barHeight(60)
      .onChange((index: number) => {
        // ä¸ºTabåˆ‡æ¢æ·»åŠ åŠ¨ç”»æ•ˆæœ
        animateTo({
          duration: 200,
          curve: Curve.Sharp
        }, () => {
          this.selectedIndex = index
          // æ›´æ–°Poetry Live tabçš„å¯è§æ€§
          this.poetryLiveVisible = (index === 3);
        });
      })
      // ä¸ºæ•´ä¸ªTabsç»„ä»¶æ·»åŠ æ·¡å…¥æ·¡å‡ºåŠ¨ç”»
      .animation({
        duration: 200,
        curve: Curve.Sharp
      })
    }
    .width('100%')
    .height('100%')
    .backgroundColor($r('app.color.page_background'))
  }
}