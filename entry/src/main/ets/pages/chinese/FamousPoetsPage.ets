import router from '@ohos.router';

// å®šä¹‰è¯—è¯åˆ†ç±»ä¸»é¢˜æ¥å£
interface FeihuaTheme {
  id: number;
  name: string;
  description: string;
  icon: string;
  keyword: string; // ç”¨äºç­›é€‰è¯—è¯çš„å…³é”®å­—
}

// å®šä¹‰å‚æ•°æ¥å£
interface ThemeItemParam {
  theme: FeihuaTheme;
  isPageLoaded: boolean;
  index: number;
}

@Entry
@Component
export struct FamousPoetsPage {
  // è¯—è¯åˆ†ç±»ä¸»é¢˜åˆ†ç±»åˆ—è¡¨
  @State private themes: FeihuaTheme[] = [
    {
      id: 1,
      name: 'å†™æ™¯',
      description: 'å±±æ°´é£å…‰ï¼Œå››å­£æ›´è¿­ï¼Œæç»˜å¤§è‡ªç„¶çš„å£®ç¾ä¸ç§€ä¸½',
      icon: 'ğŸï¸',
      keyword: 'å±±|æ°´|æ±Ÿ|æ¹–|äº‘|é›¨|é›ª|é£|æ—¥|æœˆ'
    },
    {
      id: 2,
      name: 'å†™èŠ±',
      description: 'ç™¾èŠ±é½æ”¾ï¼ŒèŠ³é¦™å››æº¢ï¼Œå’å¹èŠ±å‰çš„å¨‡è‰³ä¸èŠ¬èŠ³',
      icon: 'ğŸŒ¸',
      keyword: 'èŠ±|æ¢…|èŠ|è²|æ¡ƒ|æ¢¨|å…°|æ¡‚|èŠ™è“‰|ç‰¡ä¸¹'
    },
    {
      id: 3,
      name: 'å†™è¾¹å¡',
      description: 'é“é©¬é‡‘æˆˆï¼Œé»„æ²™æ¼«å¤©ï¼Œè¯‰è¯´è¾¹å…³å°†å£«çš„è±ªæƒ…å£®å¿—',
      icon: 'âš”ï¸',
      keyword: 'å¡|å…³|æˆ˜|å¾|æˆ|èƒ¡|ç¾Œ|çƒ½ç«|é“è¡£|ç‰é—¨'
    },
    {
      id: 4,
      name: 'å†™çˆ±æƒ…',
      description: 'ç›¸æ€ç»µç»µï¼Œæƒ…æ·±æ„é•¿ï¼Œä¼ é€’æ‹äººé—´çš„æ·±æƒ…åšæ„',
      icon: 'ğŸ’•',
      keyword: 'çˆ±|æƒ…|æ€|ç›¸æ€|ç¾äºº|ä½³äºº|å›|å¦¾|å¤«|å¦»'
    },
    {
      id: 5,
      name: 'å†™æ€ä¹¡',
      description: 'ä¸¾å¤´æœ›æœˆï¼Œä½å¤´æ€ä¹¡ï¼Œè¡¨è¾¾æ¸¸å­å¯¹æ•…åœŸçš„æ·±æ·±çœ·æ‹',
      icon: 'ğŸ ',
      keyword: 'ä¹¡|å½’|å®¶|æ•…ä¹¡|æ€å½’|å®¢|æ¸¸å­|è¿œ|ç¦»å®¶'
    },
    {
      id: 6,
      name: 'å†™ç”°å›­',
      description: 'é˜¡é™Œçºµæ¨ªï¼Œé¸¡çŠ¬ç›¸é—»ï¼Œæç»˜ç”°å›­ç”Ÿæ´»çš„æ¬æ·¡é—²é€‚',
      icon: 'ğŸŒ¾',
      keyword: 'ç”°|å›­|å†œ|è€•|æ¡‘|éº¦|ç¨»|æ‘|é‡|ç‰›ç¾Š'
    },
    {
      id: 7,
      name: 'å†™ç¦»åˆ«',
      description: 'ä¾ä¾æƒœåˆ«ï¼Œé»¯ç„¶é”€é­‚ï¼ŒæŠ’å‘ç¦»æ„åˆ«ç»ªçš„ä¸‡èˆ¬ä¸èˆ',
      icon: 'ğŸ‘‹',
      keyword: 'åˆ«|ç¦»|é€|è¡Œ|å»|å½’|åˆ†|æ•£|è¿œè¡Œ|æƒœåˆ«'
    },
    {
      id: 8,
      name: 'å†™å­¤ç‹¬',
      description: 'ç‹¬åå¹½ç¯ï¼Œå½¢å½±ç›¸åŠï¼Œå€¾è¯‰å†…å¿ƒçš„å¯‚å¯ä¸å­¤å¯‚',
      icon: 'ğŸ˜”',
      keyword: 'å­¤|ç‹¬|å¯‚|å¯|å†·|æ¸…|æ„|ç©º|å•|å¹½'
    },
    {
      id: 9,
      name: 'å†™å£®å¿—',
      description: 'è±ªæƒ…ä¸‡ä¸ˆï¼Œå¿—åœ¨åƒé‡Œï¼Œå½°æ˜¾æŠ¥å›½å£®å¿—ä¸å‡Œäº‘ä¹‹æ°”',
      icon: 'ğŸ¦…',
      keyword: 'å¿—|é›„|å£®|è±ª|æ°”|åŠŸ|å‹‹|æŠ¥å›½|å‡Œäº‘|ä¸‡é‡Œ'
    },
    {
      id: 10,
      name: 'å†™èŒ¶',
      description: 'æ¸…èŒ—é£˜é¦™ï¼Œç¦…èŒ¶ä¸€å‘³ï¼Œå“å‘³èŒ¶æ–‡åŒ–çš„é›…è‡´ä¸éŸµå‘³',
      icon: 'ğŸµ',
      keyword: 'èŒ¶|èŒ—|æ³‰|ç…®|å“|é¦™|æ¸…|é†’|é¥®|å£¶'
    }
  ];

  @State isPageLoaded: boolean = false;

  aboutToAppear(): void {
    // é¡µé¢å³å°†å‡ºç°æ—¶è§¦å‘ï¼Œå»¶è¿Ÿä¸€å°æ®µæ—¶é—´åè®¾ç½®é¡µé¢å·²åŠ è½½çŠ¶æ€
    setTimeout(() => {
      this.isPageLoaded = true;
    }, 100);
  }

  build() {
    Column() {
      Row() {
        Text('è¯—è¯åˆ†ç±»')
          .fontSize(24)
          .fontWeight(FontWeight.Bold)
          .layoutWeight(1)
          .textAlign(TextAlign.Center)
      }
      .height(60)
      .width('100%')
      .alignItems(VerticalAlign.Center)
      .backgroundColor($r('app.color.card_background'))

      // ä¸»é¢˜åˆ†ç±»åˆ—è¡¨
      List({ space: 15 }) {
        ForEach(this.themes, (theme: FeihuaTheme, index: number) => {
          ListItem() {
            this.ThemeListItem({ theme: theme, isPageLoaded: this.isPageLoaded, index: index });
          }
        }, (theme: FeihuaTheme) => theme.id.toString())
      }
      .layoutWeight(1)
      .padding({ left: 20, right: 20, top: 20, bottom: 20 })
      .edgeEffect(EdgeEffect.Spring)
    }
    .width('100%')
    .height('100%')
    .backgroundImage($r('app.media.math_bg'))
    .backgroundImageSize(ImageSize.Cover)
  }

  @Builder
  ThemeListItem(param: ThemeItemParam) {
    Column() {
      Row() {
        // ä¸»é¢˜å›¾æ ‡
        Text(param.theme.icon)
          .fontSize(48)
          .margin({ right: 15 })
        
        Column() {
          Text(param.theme.name)
            .fontSize(22)
            .fontWeight(FontWeight.Bold)
            .fontColor($r('app.color.text_primary'))
          
          Text(param.theme.description)
            .fontSize(13)
            .fontColor($r('app.color.text_secondary'))
            .margin({ top: 8 })
            .lineHeight(20)
        }
        .layoutWeight(1)
        .alignItems(HorizontalAlign.Start)
        
        // ç®­å¤´å›¾æ ‡
        Text('>')
          .fontSize(24)
          .fontColor($r('app.color.text_tertiary'))
      }
      .width('100%')
      .padding(20)
    }
    .width('100%')
    .backgroundColor($r('app.color.card_background'))
    .borderRadius(15)
    .shadow({ 
      radius: 10, 
      color: $r('app.color.text_tertiary'), 
      offsetX: 0, 
      offsetY: 5 
    })
    .onClick(() => {
      // è·³è½¬åˆ°ä¸»é¢˜è¯—è¯åˆ—è¡¨é¡µ,ä¼ é€’ä¸»é¢˜ä¿¡æ¯
      router.pushUrl({ 
        url: 'pages/chinese/ThemePoemsPage',
        params: {
          themeId: param.theme.id,
          themeName: param.theme.name
        }
      });
    })
    // æ·»åŠ è¿›å…¥åŠ¨ç”»æ•ˆæœ
    .scale({ 
      x: param.isPageLoaded ? 1 : 0.8,
      y: param.isPageLoaded ? 1 : 0.8
    })
    .opacity(param.isPageLoaded ? 1 : 0)
    .transform({
      translate: { y: param.isPageLoaded ? 0 : 15 }
    })
    .animation({
      duration: 400,
      curve: Curve.EaseInOut,
      delay: param.index * 80 // æ¯ä¸ªé¡¹ä¾æ¬¡å»¶è¿ŸåŠ¨ç”»ï¼Œè¥é€ æ³¢æµªæ•ˆæœ
    })
  }
}