# 飞花令主题分类功能实现说明

## 功能概述

成功将"著名诗人"模块改造为"飞花令"主题分类模块,用户可以按照不同主题浏览唐诗宋词。

## 实现的功能

### 1. 飞花令主题分类页面 (FamousPoetsPage.ets)

**10个主题分类:**

| 序号 | 主题名称 | 图标 | 描述 | 关键词 |
|------|---------|------|------|--------|
| 1 | 写景 | 🏞️ | 山水风光,四季更迭,描绘大自然的壮美与秀丽 | 山\|水\|江\|湖\|云\|雨\|雪\|风\|日\|月 |
| 2 | 写花 | 🌸 | 百花齐放,芳香四溢,咏叹花卉的娇艳与芬芳 | 花\|梅\|菊\|莲\|桃\|梨\|兰\|桂\|芙蓉\|牡丹 |
| 3 | 写边塞 | ⚔️ | 铁马金戈,黄沙漫天,诉说边关将士的豪情壮志 | 塞\|关\|战\|征\|戍\|胡\|羌\|烽火\|铁衣\|玉门 |
| 4 | 写爱情 | 💕 | 相思绵绵,情深意长,传递恋人间的深情厚意 | 爱\|情\|思\|相思\|美人\|佳人\|君\|妾\|夫\|妻 |
| 5 | 写思乡 | 🏠 | 举头望月,低头思乡,表达游子对故土的深深眷恋 | 乡\|归\|家\|故乡\|思归\|客\|游子\|远\|离家 |
| 6 | 写田园 | 🌾 | 阡陌纵横,鸡犬相闻,描绘田园生活的恬淡闲适 | 田\|园\|农\|耕\|桑\|麦\|稻\|村\|野\|牛羊 |
| 7 | 写离别 | 👋 | 依依惜别,黯然销魂,抒发离愁别绪的万般不舍 | 别\|离\|送\|行\|去\|归\|分\|散\|远行\|惜别 |
| 8 | 写孤独 | 😔 | 独坐幽篁,形影相吊,倾诉内心的寂寞与孤寂 | 孤\|独\|寂\|寞\|冷\|清\|愁\|空\|单\|幽 |
| 9 | 写壮志 | 🦅 | 豪情万丈,志在千里,彰显报国壮志与凌云之气 | 志\|雄\|壮\|豪\|气\|功\|勋\|报国\|凌云\|万里 |
| 10 | 写茶 | 🍵 | 清茗飘香,禅茶一味,品味茶文化的雅致与韵味 | 茶\|茗\|泉\|煮\|品\|香\|清\|醒\|饮\|壶 |

**界面特点:**
- 使用大号 emoji 图标,直观美观
- 卡片式设计,带阴影效果
- 渐入动画,波浪效果依次呈现
- 点击卡片跳转到对应主题的诗词列表

### 2. 诗词列表页筛选功能 (PoemsListPage.ets)

**新增功能:**
1. **接收路由参数**
   - `themeKeyword`: 主题关键词(正则表达式)
   - `themeName`: 主题名称

2. **主题筛选逻辑**
   ```typescript
   // 根据飞花令主题筛选
   if (this.themeKeyword) {
     const regex = new RegExp(this.themeKeyword);
     baseList = baseList.filter((p: Poem) => 
       regex.test(p.title) || regex.test(p.content)
     );
   }
   ```

3. **动态标题显示**
   - 有主题时: `飞花令·写景`
   - 无主题时: `唐诗鉴赏`
   
4. **副标题提示**
   - 有主题时: `筛选主题:写景`
   - 无主题时: `清风明月 · 诗酒年华`

5. **提示文案**
   - 有主题时: `探索「写景」主题诗词:点击查看详情`
   - 无主题时: `探索唐诗:点击诗卡查看详情与解析`

### 3. 主导航更新 (MainPage.ets)

**修改内容:**
- Tab 标题: `著名诗人` → `飞花令`
- Tab 图标: 🖋️ → 🌸

## 技术实现

### 关键代码片段

#### 1. 主题数据结构
```typescript
interface FeihuaTheme {
  id: number;
  name: string;
  description: string;
  icon: string;
  keyword: string; // 用于筛选诗词的关键字
}
```

#### 2. 路由跳转
```typescript
router.pushUrl({ 
  url: 'pages/chinese/PoemsListPage',
  params: {
    themeKeyword: param.theme.keyword,
    themeName: param.theme.name
  }
});
```

#### 3. 正则表达式筛选
使用正则表达式实现灵活的关键词匹配:
- `山|水|江|湖|云|雨|雪|风|日|月` - 匹配任意一个关键词
- 同时搜索诗词标题和内容

## 用户使用流程

1. 用户打开应用,点击底部导航栏"飞花令"Tab
2. 看到10个主题分类卡片
3. 点击感兴趣的主题(如"写景")
4. 进入诗词列表页,自动筛选出包含相关关键词的诗词
5. 页面标题显示当前主题,方便用户了解当前浏览内容
6. 用户可继续使用搜索、收藏等功能

## 数据来源

参考了古诗文网(https://www.gushiwen.cn/)的分类体系,结合中国传统诗词的常见主题进行设计。

## 扩展性

### 易于添加新主题
只需在 `FamousPoetsPage.ets` 的 `themes` 数组中添加新对象:
```typescript
{
  id: 11,
  name: '写酒',
  description: '对酒当歌,人生几何,抒发饮酒时的情怀',
  icon: '🍶',
  keyword: '酒|醉|饮|樽|杯|觞'
}
```

### 可配置关键词
每个主题的 `keyword` 字段使用正则表达式语法,可以灵活调整:
- 添加新关键词: `'山|水|江|湖|溪'`
- 排除某些词: 使用正则表达式的否定前瞻
- 精确匹配: 使用词边界 `\\b`

## 文件修改清单

1. ✅ `entry/src/main/ets/pages/chinese/FamousPoetsPage.ets` - 完全重构
2. ✅ `entry/src/main/ets/pages/chinese/PoemsListPage.ets` - 添加主题筛选功能
3. ✅ `entry/src/main/ets/pages/MainPage.ets` - 更新Tab标题和图标

## 后续优化建议

1. **数据统计**
   - 在主题卡片上显示该主题下的诗词数量
   - 例如: "写景 (共32首)"

2. **主题配色**
   - 不同主题使用不同的主题色
   - 增强视觉识别度

3. **空状态处理**
   - 当某主题下没有诗词时,显示友好提示
   - 建议用户尝试其他主题

4. **收藏同步**
   - 在主题列表中标识包含已收藏诗词的主题
   - 快速定位喜欢的内容

5. **主题推荐**
   - 基于用户浏览历史推荐相关主题
   - 智能关联不同主题

## 遵循的规范

严格遵循 `ARKTS_RULES.md` 中的开发规范:
- ✅ 所有对象字面量显式类型声明
- ✅ 避免使用解构赋值
- ✅ build() 方法仅包含UI组件
- ✅ 状态属性正确初始化
- ✅ 使用正确的装饰器(@State, @Prop等)
